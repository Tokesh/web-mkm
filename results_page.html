
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home / X</title>
    <link rel="stylesheet" href="css/home.css">
</head>
<body>
    <section>
        <!-- Это левая панелька -->
        <div class="main-left-bar">
            <div class="main-left-bar-1">
                <ul>
                    <li><a href="home.html"><img src="images/x-logo.png" alt="x-logo" width="30px"></a></li>
                    <li><a href="home.html"><img src="images/home.png" alt="home" width="30px">Home</a></li>
                    <li><a href="explore.html"><img src="images/find.png" alt="explore" width="30px">Explore</a></li>
                    <li><a href="notifications.html"><img src="images/notifications.png" alt="notifications" width="30px">Notifications</a></li>
                    <li><a href="messages.html"><img src="images/messages.png" alt="messages" width="30px">Messages</a></li>
                    <li><a href="lists.html"><img src="images/lists.png" alt="lists" width="30px">Lists</a></li>
                    <li><a href="communities.html"><img src="images/communities.png" alt="communities" width="30px">Communities</a></li>
                    <li><a href="#"><img src="images/x.png" alt="premium" width="30px">Premium</a></li>
                    <li><a href="profile.html"><img src="images/profile.png" alt="profile" width="30px">Profile</a></li>
                    <li><a href="#"><img src="images/more.png" alt="more" width="30px">More</a></li>
                </ul>
                <button style="background: dodgerblue;height: 50px;width: 100%;border: none;font-size: 20px;color: white;font-weight: bold;border-radius: 30px;">Post</button>
            </div>
            <div class="main-left-bar-2">
                <img src="images/avatar.jpg" alt="avatar" width="50px" style="border-radius: 50px;">
                <div class="main-left-bar-2-text">
                    <h3 style="color: white">Kan</h4>
                    <h4 style="color: grey">@Kanres</h4>
                </div>
            </div>
        </div>

        <div class="main-middle-content" style="margin-left:20px;">
            <div class="main-right-bar-search" style="width:450px;">
                <a href="results_page.html" id="searchLink">
                    <img src="images/find.png" alt="search" width="24px" height="24px">
                </a>
                <input type="text" id="searchInput" placeholder="Search" style="border: none; background: rgb(47, 47, 47); height: 40px; font-size: 16px; border-radius: 50px; width: 100%; color: white;">
            </div>  
            <div id="searchResults">

            </div>


            <div class="main-news-feed">
                <!-- Тут будут появляться посты -->
            </div>
            
        </div>
        <script>
            // Получаем сохраненный текст из localStorage
            const searchLink = document.getElementById('searchLink');
            const searchInput = document.getElementById('searchInput');
            const savedSearchQuery = localStorage.getItem('searchQuery');
            console.log(savedSearchQuery);
    
            fetch(`search.php?search=${encodeURIComponent(savedSearchQuery)}`)
                .then(response => response.json())
                .then(data => {
                    // Обновляем результаты поиска на странице
                    if (data.results.length > 0) {
                        const resultList = data.results.map(user => `
                        <div class="post" style="margin-top: 20px; display: flex; justify-content: space-between; align-items: center;">
                        <div class="post-left" style="display:flex;justify-content:left;">
                            <img src="images/avatar.jpg" alt="pfp" style="width: 40px; height: 40px; border-radius: 30px;">
                            <div class="post-content" style="margin-left: 10px;">
                                <!-- Тут имя пользователя и его ник -->
                                <div class="post-username">
                                    <p style="color: gray; font-weight: 100;"><b style="color: white;">${user.username}</b> @${user.username}</p>
                                </div>
                            </div>
                        </div>
                        <!-- Это правая часть -->
                        <div class="post-right" style="display: flex; flex-direction: row; align-items: center;">
                            <!-- Это часть с контентом -->
                            
                            <a href="premium.html" style="width: 6vw;">
                                <button style="background: dodgerblue; height: 30px; width: 5vw; border: none; font-size: 16px; color: white; font-weight: bold; border-radius: 30px; cursor: pointer;">Follow</button>
                            </a>
                        </div>
                    </div>
                            `).join('');
                        searchResults.innerHTML = `<h2 style="color:white;margin-top:20px;">Search Results:</h2>${resultList}`;
                    } else {
                        searchResults.innerHTML = '<p>No results found.</p>';
                    }

                })
                .catch(error => console.error('Error:', error));
    
            
                // При загрузке страницы
                window.addEventListener('load', function () {
                    console.log('11');
                        // Получаем значение из localStorage
                        const savedSearchQuery = localStorage.getItem('searchQuery');
                
                        // Если значение найдено, устанавливаем его в поле ввода
                        if (savedSearchQuery) {
                            searchInput.value = savedSearchQuery;
                        }
                    });
                searchLink.addEventListener('click', function () {
                    // Получаем значение из поля ввода
                    const searchText = searchInput.value;
            
                    // Сохраняем значение в localStorage
                    localStorage.setItem('searchQuery', searchText);
                });
        </script>
        <div class="main-right-bar">
                      
            <div class="main-right-bar-premium">
                <h2 style="color: white;">Subscribe to Premium</h2>
                <h4 style="color: white;">Subscribe to unlock new features and if eligible, receive a share of ads revenue.</h4>
                <a href="premium.html" style="width: 7vw;"><button style="background: dodgerblue;height: 30px;width: 7vw;border: none;font-size: 16px;color: white;font-weight: bold;border-radius: 30px;cursor: pointer;;">Subscribe</button></a>
            </div>

            <div class="trending">
                <h1 style="color: white;padding: 1vw 0 0 1vw;">Trends for you</h1>
                <div class="trends-box">
                    <div class="trends-item">
                        <p style="color: gray;font-size: 14px;">News • Trending</p>
                        <h4 style="color: white;">Hamas</h4>
                        <p style="color: grey;font-size: 14px;">2.72M posts</p>
                    </div>

                    <div class="trends-item">
                        <p style="color: gray;font-size: 14px;">Only on Twitter • Trending</p>
                        <h4 style="color: white;">#TheAmazingDigitalCircus</h4>
                        <p style="color: grey;font-size: 14px;">119K posts</p>
                    </div>

                    <div class="trends-item">
                        <p style="color: gray;font-size: 14px;">News • Trending</p>
                        <h4 style="color: white;">Israel</h4>
                        <p style="color: grey;font-size: 14px;">6.96M posts</p>
                    </div>

                    <div class="trends-item">
                        <p style="color: gray;font-size: 14px;">Trending in Kazakhstan</p>
                        <h4 style="color: white;">Ризли</h4>
                    </div>

                    <div class="trends-item">
                        <p style="color: gray;font-size: 14px;">Trending in Kazakhstan</p>
                        <h4 style="color: white;">China</h4>
                        <p style="color: grey;font-size: 14px;">358K posts</p>
                    </div>

                    <div class="trends-item">
                        <a href="#" style="color: dodgerblue;font-size: 16px;font-weight: bold;">Show more</a>
                    </div>
                </div>
            </div>
        </div>
        <script>
            // Fetch user data from the PHP script using the fetch API
            fetch('get_user_info.php')
                .then(response => response.json())
                .then(user => {
                    if (user) {
                        console.log
                        // Get the elements where user data will be displayed
                        const userNameElement = document.querySelector('.user-info h2');
                        const userUsernameElement = document.querySelector('.user-info h4');
                        const topUsernameElement = document.querySelector('.profile-info h1');
                        
                        const leftTopUsernameElement = document.querySelector('.main-left-bar-2-text h3');
                        const leftBotnameElement = document.querySelector('.main-left-bar-2-text h4');
                        // Update HTML content with user informatio
                        leftTopUsernameElement.textContent = `${user.username}`;
                        leftBotnameElement.textContent = `@${user.username}`;
                        userNameElement.style.color = 'white';
                    }
                })
                .catch(error => console.error('Error:', error));
        </script>
    </section>
</body>
</html>